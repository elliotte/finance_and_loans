require 'rails_helper'

describe Tag do
  
  describe 'IFRS and ukGAAP' do

    context "reading master CSV" do
      it 'should load master IFRS csv' do
        expect(CSV).to receive(:open)
        Tag.load_master_ifrs_csv
      end
      it 'should load master GAAP csv' do
        expect(CSV).to receive(:open)
        Tag.load_master_gaap_csv
      end
    end

    context "report Manager tag options" do
      it 'should return IFRS user options for report mgr' do
        tags = Tag.report_mgr_ifrs_options
        expect(tags).to eq( ["Revenue", "Other trading income", "Cost of sales", "Other direct costs", "Other operating income", "Finance income", "Share of post-tax profits of equity associates", "Share of post-tax profits of equity joint ventures", "Administrative expenses", "Distribution expenses", "Other expenses", "Finance expense", "Tax expense", "Changes in inventories of finished goods and work in progress", "Raw materials and consumables used", "Employee benefit expenses", "Depreciation and amortisation expense", "Research and development", "Loss on property revaluation", "Remeasurements of defined benefit pension schemes", "Share of associates' other", "Exchange gains arising on translation of foreign operations", "Inventories", "Trade and other receivables", "Available-for-sale investments", "Derivative financial assets", "Current tax assets", "Other assets", "Cash and cash equivalents", "Assets in disposal groups classified as held for sale", "Finance lease receiveable", "Property plant and equipment", "Investment property", "Goodwill", "Other intangible assets", "Finance lease receiveable", "Other financial assets", "Other assets", "Investments in equity-accounted associates", "Investments in equity-accounted joint ventures", "Available-for-sale investments", "Derivative financial assets", "Other receivables", "Deferred tax assets", "Trade and other payables", "Loans and borrowings", "Derivative financial liabilities", "Income Tax Payable", "Employee benefit liabilities", "Provisions", "Liabilities directly associated with assets in HFS", "Loans and borrowings", "Derivative financial liabilities", "Employee benefit liabilities", "Provisions ", "Deferred tax liability", "Other financial liabilities", "Deferred revenue", "Other liabilities", "Revaluation reserve", "Available-for-sale reserve", "Cash flow hedging reserve", "Foreign exchange reserve", "Issued capital and share premium", "Other reserves", "Retained earnings", "Equity attributable to parent", "Non-controlling interest", "Share capital", "Share premium reserve", "Shares to be issued", "No-Mapping"])
        expect(tags.count).to eq 72
      end
      it 'should return GAAP user options for report mgr' do
        tags = Tag.report_mgr_gaap_options
        expect(tags).to eq( ["Sales", "Other sales", "Purchases", "Decrease in stocks", "Subcontractor costs", "Direct labour", "Carriage", "Discounts allowed", "Commissions payable", "Other direct costs", "Other operating income", "Distribution costs", "Wages and salaries", "Directors' salaries", "Pensions", "Bonuses", "Employer's NI", "Temporary staff and recruitment", "Staff training and welfare", "Travel and subsistence", "Motor expenses", "Entertaining", "Telephone and fax", "Postage", "Stationery and printing", "Courier services", "Information and publications", "Subscriptions", "Bank charges", "Insurance", "Equipment expensed", "Equipment hire", "Software", "Repairs and maintenance", "Depreciation", "Amortisation of goodwill", "Bad debts", "Sundry expenses", "Audit fees", "Accountancy fees", "Solicitors fees", "Consultancy fees", "Management fees", "Advertising and PR", "Other legal and professional", "Depreciation of owned fixed assets", "Depreciation of leased assets", "Amortisation of goodwill", "Directors' remuneration", "Pension costs", "Auditors' remuneration", "Exceptional costs", "Non-equity dividends", "Interest receiveable", "Other interest receceiveable", "Bank loan interest payable", "Operating lease charges", "Hire purchase charges", "Finance lease charges", "Other finance income", "Other interest payable", "Other finance costs", "Taxation on profit", "Equity dividends", "Non-equity dividends", "Cash in hand", "Plant & machinery cost - b/fwd", "Plant & machinery cost - additions", "Plant & machinery cost - disposals", "Plant & machinery depn - b/fwd", "Plant & machinery depn - provided in year", "Plant & machinery depn - disposals", "Motor vehicles cost - b/fwd", "Motor vehicles cost - additions", "Motor vehicles cost - disposals", "Motor vehicles depn - b/fwd", "Motor vehicles depn - provided in year", "Motor vehicles depn - disposals", "Land & buildings cost - b/fwd", "Land & buildings cost - additions", "Land & buildings cost - revaluation", "Land & buildings cost - disposals", "Land & buildings depn - b/fwd", "Land & buildings depn - charge for the year", "Land & buildings depn - revaluation", "Land & buildings depn - disposals", "Goodwill cost", "Goodwill additions", "Goodwill disposals", "Goodwill amortisation b/fwd", "Goodwill amortisation charge for the year", "Goodwill amortisation on on disposals", "Goodwill amortisation c/fwd", "Intangible assets cost - b/fwd", "Intangible assets cost - additions", "Intangible assets cost - disposals", "Intangible assets  amortisation - b/fwd", "Intangible assets amortisation - provided in year", "Intangible assets  amortisation - disposals", "Investments in subsidiary undertakings cost - b/fwd", "Investments in subsidiary undertakings cost - additions", "Investments in subsidiary undertakings cost - disposals", "Other investments cost - b/fwd", "Other investments cost - additions", "Other investments cost - disposals", "Listed investments cost - b/fwd", "Listed investments cost - additions", "Listed investments cost - disposals", "Unlisted investments cost - b/fwd", "Unlisted investments cost - additions", "Unlisted investments cost - disposals", "Trade debtors", "Amounts owed by group undertakings", "Deferred tax asset ", "Prepayments and accrued income", "Other debtors", "Non-equity preference shares", "Bank loans and overdrafts", "Obligations under lease contracts", "Trade creditors", "Amounts owed to group undertakings ", "Corporation tax", "Other taxes and social security costs", "VAT payments", "Accruals and deferred sales", "Other creditors", "Non-equity preference shares", "Bank loans", "Obligations under lease contracts", "Amounts owed to group undertakings ", "Other creditors", "Profit and loss account", "Ordinary shares", "B Ordinary shares", "Share premium", "Revaluation reserve - b/fwd", "Arising on revaluation during the year", "Capital redemption reserve - b/fwd", "Transfer from the profit and loss account", "Prior year adjustments", "Dividends", "Transfer to capital redemption reserve", "No-Mapping"])
        expect(tags.count).to eq 143
      end
      it 'should have no-mapping option' do
        ifrs = Tag.report_mgr_ifrs_options
        gaap = Tag.report_mgr_gaap_options
        expect(ifrs.last).to eq "No-Mapping"
        expect(gaap.last).to eq "No-Mapping"
      end
    end

    context "user select options" do
      it 'should return IFRS user Select options' do
        tags = Tag.ifrs_user_select_options
        expect(tags).to eq( ["Revenue", "Other trading income", "Cost of sales", "Other direct costs", "Other operating income", "Finance income", "Share of post-tax profits of equity associates", "Share of post-tax profits of equity joint ventures", "Administrative expenses", "Distribution expenses", "Other expenses", "Finance expense", "Tax expense", "Changes in inventories of finished goods and work in progress", "Raw materials and consumables used", "Employee benefit expenses", "Depreciation and amortisation expense", "Research and development", "Loss on property revaluation", "Remeasurements of defined benefit pension schemes", "Share of associates' other", "Exchange gains arising on translation of foreign operations", "Inventories", "Trade and other receivables", "Available-for-sale investments", "Derivative financial assets", "Current tax assets", "Other assets", "Cash and cash equivalents", "Assets in disposal groups classified as held for sale", "Finance lease receiveable", "Property plant and equipment", "Investment property", "Goodwill", "Other intangible assets", "Finance lease receiveable", "Other financial assets", "Other assets", "Investments in equity-accounted associates", "Investments in equity-accounted joint ventures", "Available-for-sale investments", "Derivative financial assets", "Other receivables", "Deferred tax assets", "Trade and other payables", "Loans and borrowings", "Derivative financial liabilities", "Income Tax Payable", "Employee benefit liabilities", "Provisions", "Liabilities directly associated with assets in HFS", "Loans and borrowings", "Derivative financial liabilities", "Employee benefit liabilities", "Provisions ", "Deferred tax liability", "Other financial liabilities", "Deferred revenue", "Other liabilities", "Revaluation reserve", "Available-for-sale reserve", "Cash flow hedging reserve", "Foreign exchange reserve", "Issued capital and share premium", "Other reserves", "Retained earnings", "Equity attributable to parent", "Non-controlling interest", "Share capital", "Share premium reserve", "Shares to be issued", "No-Mapping"]
)
        expect(tags.count).to eq 72
      end
      it 'should return GAAP select options' do
        tags = Tag.gaap_user_options
        expect(tags).to eq( ["Sales", "Other sales", "Purchases", "Decrease in stocks", "Subcontractor costs", "Direct labour", "Carriage", "Discounts allowed", "Commissions payable", "Other direct costs", "Other operating income", "Distribution costs", "Wages and salaries", "Directors' salaries", "Pensions", "Bonuses", "Employer's NI", "Temporary staff and recruitment", "Staff training and welfare", "Travel and subsistence", "Motor expenses", "Entertaining", "Rent", "Rates", "Service charges", "Light and heat", "Cleaning", "Use of home", "IT costs", "Digital and internet", "Telephone and fax", "Postage", "Stationery and printing", "Courier services", "Information and publications", "Subscriptions", "Bank charges", "Insurance", "Equipment expensed", "Equipment hire", "Software", "Repairs and maintenance", "Depreciation", "Amortisation of goodwill", "Bad debts", "Sundry expenses", "Audit fees", "Accountancy fees", "Solicitors fees", "Consultancy fees", "Management fees", "Advertising and PR", "Other legal and professional", "Depreciation of owned fixed assets", "Depreciation of leased assets", "Amortisation of goodwill", "Directors' remuneration", "Pension costs", "Auditors' remuneration", "Exceptional costs", "Non-equity dividends", "Interest receiveable", "Other interest receceiveable", "Bank loan interest payable", "Operating lease charges", "Hire purchase charges", "Finance lease charges", "Other finance income", "Other interest payable", "Other finance costs", "Taxation on profit", "Equity dividends", "Non-equity dividends", "Trade debtors", "Trade creditors", "Corporation tax", "Other taxes and social security costs", "Bank loans", "Obligations under lease contracts", "Plant & machinery cost - additions", "Plant & machinery cost - disposals", "Motor vehicles cost - additions", "Motor vehicles cost - disposals", "Land & buildings cost - additions", "Land & buildings cost - disposals", "Intangible assets cost - additions", "Intangible assets cost - disposals", "Other investments cost - additions", "Other investments cost - disposals", "No-Mapping"])
        expect(tags.count).to eq 90
      end
    end

    context "MAPPINGS tags" do
      it 'can load mappings UKGAAP' do
        tags = Tag.load_monea_tag_mappings("UKGAAP")
        expect(tags).to eq( {"Sales"=>"gp_sales", "Other sales"=>"gp_sales", "Purchases"=>"gp_cos", "Decrease in stocks"=>"gp_cos", "Subcontractor costs"=>"gp_cos", "Direct labour"=>"gp_cos", "Carriage"=>"gp_cos", "Discounts allowed"=>"gp_cos", "Commissions payable"=>"gp_cos", "Other direct costs"=>"gp_cos", "Other operating income"=>"op_sales", "Distribution costs"=>"op_dis", "Wages and salaries"=>"op_admin", "Directors' salaries"=>"op_admin", "Pensions"=>"op_admin", "Bonuses"=>"op_admin", "Employer's NI"=>"op_admin", "Temporary staff and recruitment"=>"op_admin", "Staff training and welfare"=>"op_admin", "Travel and subsistence"=>"op_admin", "Motor expenses"=>"op_admin", "Entertaining"=>"op_admin", "Telephone and fax"=>"op_admin", "Postage"=>"op_admin", "Stationery and printing"=>"op_admin", "Courier services"=>"op_admin", "Information and publications"=>"op_admin", "Subscriptions"=>"op_admin", "Bank charges"=>"op_admin", "Insurance"=>"op_admin", "Equipment expensed"=>"op_admin", "Equipment hire"=>"op_admin", "Software"=>"op_admin", "Repairs and maintenance"=>"op_admin", "Depreciation"=>"op_admin", "Amortisation of goodwill"=>"op_admin", "Bad debts"=>"op_admin", "Sundry expenses"=>"op_admin", "Audit fees"=>"op_admin", "Accountancy fees"=>"op_admin", "Solicitors fees"=>"op_admin", "Consultancy fees"=>"op_admin", "Management fees"=>"op_admin", "Advertising and PR"=>"op_admin", "Other legal and professional"=>"op_admin", "Depreciation of owned fixed assets"=>"op_admin", "Depreciation of leased assets"=>"op_admin", "Directors' remuneration"=>"op_admin", "Pension costs"=>"op_admin", "Auditors' remuneration"=>"op_admin", "Exceptional costs"=>"op_admin", "Non-equity dividends"=>"pat_cos", "Interest receiveable"=>"pbiat_sales", "Other interest receceiveable"=>"pbiat_sales", "Bank loan interest payable"=>"pbiat_cos", "Operating lease charges"=>"pbiat_cos", "Hire purchase charges"=>"pbiat_cos", "Finance lease charges"=>"pbiat_cos", "Other finance income"=>"pbiat_sales", "Other interest payable"=>"pbiat_cos", "Other finance costs"=>"pbiat_cos", "Taxation on profit"=>"tax_cos", "Equity dividends"=>"pat_cos", "Cash in hand"=>"curr_assets", "Plant & machinery cost - b/fwd"=>"fa_tang", "Plant & machinery cost - additions"=>"fa_tang", "Plant & machinery cost - disposals"=>"fa_tang", "Plant & machinery depn - b/fwd"=>"fa_tang", "Plant & machinery depn - provided in year"=>"fa_tang", "Plant & machinery depn - disposals"=>"fa_tang", "Motor vehicles cost - b/fwd"=>"fa_tang", "Motor vehicles cost - additions"=>"fa_tang", "Motor vehicles cost - disposals"=>"fa_tang", "Motor vehicles depn - b/fwd"=>"fa_tang", "Motor vehicles depn - provided in year"=>"fa_tang", "Motor vehicles depn - disposals"=>"fa_tang", "Land & buildings cost - b/fwd"=>"fa_tang", "Land & buildings cost - additions"=>"fa_tang", "Land & buildings cost - revaluation"=>"fa_tang", "Land & buildings cost - disposals"=>"fa_tang", "Land & buildings depn - b/fwd"=>"fa_tang", "Land & buildings depn - charge for the year"=>"fa_tang", "Land & buildings depn - revaluation"=>"fa_tang", "Land & buildings depn - disposals"=>"fa_tang", "Goodwill cost"=>"fa_intang", "Goodwill additions"=>"fa_intang", "Goodwill disposals"=>"fa_intang", "Goodwill amortisation b/fwd"=>"fa_intang", "Goodwill amortisation charge for the year"=>"fa_intang", "Goodwill amortisation on on disposals"=>"fa_intang", "Goodwill amortisation c/fwd"=>"fa_intang", "Intangible assets cost - b/fwd"=>"fa_intang", "Intangible assets cost - additions"=>"fa_intang", "Intangible assets cost - disposals"=>"fa_intang", "Intangible assets  amortisation - b/fwd"=>"fa_intang", "Intangible assets amortisation - provided in year"=>"fa_intang", "Intangible assets  amortisation - disposals"=>"fa_intang", "Investments in subsidiary undertakings cost - b/fwd"=>"fa_invest", "Investments in subsidiary undertakings cost - additions"=>"fa_invest", "Investments in subsidiary undertakings cost - disposals"=>"fa_invest", "Other investments cost - b/fwd"=>"fa_invest", "Other investments cost - additions"=>"fa_invest", "Other investments cost - disposals"=>"fa_invest", "Listed investments cost - b/fwd"=>"fa_invest", "Listed investments cost - additions"=>"fa_invest", "Listed investments cost - disposals"=>"fa_invest", "Unlisted investments cost - b/fwd"=>"fa_invest", "Unlisted investments cost - additions"=>"fa_invest", "Unlisted investments cost - disposals"=>"fa_invest", "Trade debtors"=>"curr_assets", "Amounts owed by group undertakings"=>"curr_assets", "Deferred tax asset "=>"curr_assets", "Prepayments and accrued income"=>"curr_assets", "Other debtors"=>"curr_assets", "Non-equity preference shares"=>"cred_greater", "Bank loans and overdrafts"=>"cred_current", "Obligations under lease contracts"=>"cred_greater", "Trade creditors"=>"cred_current", "Amounts owed to group undertakings "=>"cred_greater", "Corporation tax"=>"cred_current", "Other taxes and social security costs"=>"cred_current", "VAT payments"=>"cred_current", "Accruals and deferred sales"=>"cred_current", "Other creditors"=>"cred_greater", "Bank loans"=>"cred_greater", "Profit and loss account"=>"capital", "Ordinary shares"=>"capital", "B Ordinary shares"=>"capital", "Share premium"=>"capital", "Revaluation reserve - b/fwd"=>"capital", "Arising on revaluation during the year"=>"capital", "Capital redemption reserve - b/fwd"=>"capital", "Transfer from the profit and loss account"=>"capital", "Prior year adjustments"=>"capital", "Dividends"=>"capital", "Transfer to capital redemption reserve"=>"capital", "No-Mapping"=>"capital"})
        expect(tags.count).to eq 137
      end
      it 'can load mappings IFRS' do
        tags = Tag.load_monea_tag_mappings("IFRS")
        expect(tags).to eq( {"Revenue"=>"gp_rev", "Other trading income"=>"gp_rev", "Cost of sales"=>"gp_cos", "Other direct costs"=>"gp_cos", "Other operating income"=>"op_rev", "Finance income"=>"op_rev", "Share of post-tax profits of equity associates"=>"op_rev", "Share of post-tax profits of equity joint ventures"=>"op_rev", "Administrative expenses"=>"op_cos", "Distribution expenses"=>"op_cos", "Other expenses"=>"op_cos", "Finance expense"=>"op_cos", "Tax expense"=>"pbt_cos", "Changes in inventories of finished goods and work in progress"=>"gp_cos", "Raw materials and consumables used"=>"gp_cos", "Employee benefit expenses"=>"op_cos", "Depreciation and amortisation expense"=>"op_cos", "Research and development"=>"op_cos", "Loss on property revaluation"=>"pat_cos", "Remeasurements of defined benefit pension schemes"=>"pat_cos", "Share of associates' other"=>"pat_cos", "Exchange gains arising on translation of foreign operations"=>"op_cos", "Inventories"=>"ca", "Trade and other receivables"=>"ca", "Available-for-sale investments"=>"nca", "Derivative financial assets"=>"nca", "Current tax assets"=>"ca", "Other assets"=>"nca", "Cash and cash equivalents"=>"ca", "Assets in disposal groups classified as held for sale"=>"ca", "Finance lease receiveable"=>"nca", "Property plant and equipment"=>"nca", "Investment property"=>"nca", "Goodwill"=>"nca", "Other intangible assets"=>"nca", "Other financial assets"=>"nca", "Investments in equity-accounted associates"=>"nca", "Investments in equity-accounted joint ventures"=>"nca", "Other receivables"=>"ca", "Deferred tax assets"=>"ca", "Trade and other payables"=>"cl", "Loans and borrowings"=>"ncl", "Derivative financial liabilities"=>"ncl", "Income Tax Payable"=>"cl", "Employee benefit liabilities"=>"ncl", "Provisions"=>"cl", "Liabilities directly associated with assets in HFS"=>"cl", "Provisions "=>"ncl", "Deferred tax liability"=>"ncl", "Other financial liabilities"=>"ncl", "Deferred revenue"=>"ncl", "Other liabilities"=>"ncl", "Revaluation reserve"=>"eq", "Available-for-sale reserve"=>"eq", "Cash flow hedging reserve"=>"eq", "Foreign exchange reserve"=>"eq", "Issued capital and share premium"=>"eq", "Other reserves"=>"eq", "Retained earnings"=>"eq", "Equity attributable to parent"=>"eq", "Non-controlling interest"=>"eq", "Share capital"=>"eq", "Share premium reserve"=>"eq", "Shares to be issued"=>"eq", "No-Mapping"=>"eq"})
        expect(tags.count).to eq 65
      end
    end

    context "reportShow dashBoard master loop tags" do
      it 'should return IFRS fin stat keys for LOOP and display' do
        tags = Tag.ifrs_fin_stat_tags
        expect(tags).to eq( {:gp_rev=>["Revenue", "Other trading income"], :gp_cos=>["Cost of sales", "Other direct costs", "Changes in inventories of finished goods and work in progress", "Raw materials and consumables used"], :op_rev=>["Other operating income", "Finance income", "Share of post-tax profits of equity associates", "Share of post-tax profits of equity joint ventures"], :op_cos=>["Administrative expenses", "Distribution expenses", "Other expenses", "Finance expense", "Employee benefit expenses", "Depreciation and amortisation expense", "Research and development", "Exchange gains arising on translation of foreign operations"], :pbt_cos=>["Tax expense"], :pat_cos=>["Loss on property revaluation", "Remeasurements of defined benefit pension schemes", "Share of associates' other"], :ca=>["Inventories", "Trade and other receivables", "Available-for-sale investments", "Derivative financial assets", "Current tax assets", "Other assets", "Cash and cash equivalents", "Assets in disposal groups classified as held for sale", "Finance lease receiveable", "Other receivables", "Deferred tax assets"], :nca=>["Property plant and equipment", "Investment property", "Goodwill", "Other intangible assets", "Finance lease receiveable", "Other financial assets", "Other assets", "Investments in equity-accounted associates", "Investments in equity-accounted joint ventures", "Available-for-sale investments", "Derivative financial assets"], :cl=>["Trade and other payables", "Loans and borrowings", "Derivative financial liabilities", "Income Tax Payable", "Employee benefit liabilities", "Provisions", "Liabilities directly associated with assets in HFS"], :ncl=>["Loans and borrowings", "Derivative financial liabilities", "Employee benefit liabilities", "Provisions ", "Deferred tax liability", "Other financial liabilities", "Deferred revenue", "Other liabilities"], :eq=>["Revaluation reserve", "Available-for-sale reserve", "Cash flow hedging reserve", "Foreign exchange reserve", "Issued capital and share premium", "Other reserves", "Retained earnings", "Equity attributable to parent", "Non-controlling interest", "Share capital", "Share premium reserve", "Shares to be issued", "No-Mapping"]})
        expect(tags.keys.count).to eq 11
      end
      it 'should return GAAP fin stat keys for LOOP and display' do
        tags = Tag.gaap_fin_stat_tags
        expect(tags).to eq( {:gp_sales=>["Sales", "Other sales"], :gp_cos=>["Purchases", "Decrease in stocks", "Subcontractor costs", "Direct labour", "Carriage", "Discounts allowed", "Commissions payable", "Other direct costs"], :op_sales=>["Other operating income"], :op_dis=>["Distribution costs"], :op_admin=>["Wages and salaries", "Directors' salaries", "Pensions", "Bonuses", "Employer's NI", "Temporary staff and recruitment", "Staff training and welfare", "Travel and subsistence", "Motor expenses", "Entertaining", "Telephone and fax", "Postage", "Stationery and printing", "Courier services", "Information and publications", "Subscriptions", "Bank charges", "Insurance", "Equipment expensed", "Equipment hire", "Software", "Repairs and maintenance", "Depreciation", "Amortisation of goodwill", "Bad debts", "Sundry expenses", "Audit fees", "Accountancy fees", "Solicitors fees", "Consultancy fees", "Management fees", "Advertising and PR", "Other legal and professional", "Depreciation of owned fixed assets", "Depreciation of leased assets", "Amortisation of goodwill", "Directors' remuneration", "Pension costs", "Auditors' remuneration", "Exceptional costs", "Non-equity dividends"], :pbiat_sales=>["Interest receiveable", "Other interest receceiveable", "Other finance income"], :pbiat_cos=>["Bank loan interest payable", "Operating lease charges", "Hire purchase charges", "Finance lease charges", "Other interest payable", "Other finance costs"], :tax_cos=>["Taxation on profit"], :pat_cos=>["Equity dividends", "Non-equity dividends"], :curr_assets=>["Cash in hand", "Trade debtors", "Amounts owed by group undertakings", "Deferred tax asset ", "Prepayments and accrued income", "Other debtors"], :fa_tang=>["Plant & machinery cost - b/fwd", "Plant & machinery cost - additions", "Plant & machinery cost - disposals", "Plant & machinery depn - b/fwd", "Plant & machinery depn - provided in year", "Plant & machinery depn - disposals", "Motor vehicles cost - b/fwd", "Motor vehicles cost - additions", "Motor vehicles cost - disposals", "Motor vehicles depn - b/fwd", "Motor vehicles depn - provided in year", "Motor vehicles depn - disposals", "Land & buildings cost - b/fwd", "Land & buildings cost - additions", "Land & buildings cost - revaluation", "Land & buildings cost - disposals", "Land & buildings depn - b/fwd", "Land & buildings depn - charge for the year", "Land & buildings depn - revaluation", "Land & buildings depn - disposals"], :fa_intang=>["Goodwill cost", "Goodwill additions", "Goodwill disposals", "Goodwill amortisation b/fwd", "Goodwill amortisation charge for the year", "Goodwill amortisation on on disposals", "Goodwill amortisation c/fwd", "Intangible assets cost - b/fwd", "Intangible assets cost - additions", "Intangible assets cost - disposals", "Intangible assets  amortisation - b/fwd", "Intangible assets amortisation - provided in year", "Intangible assets  amortisation - disposals"], :fa_invest=>["Investments in subsidiary undertakings cost - b/fwd", "Investments in subsidiary undertakings cost - additions", "Investments in subsidiary undertakings cost - disposals", "Other investments cost - b/fwd", "Other investments cost - additions", "Other investments cost - disposals", "Listed investments cost - b/fwd", "Listed investments cost - additions", "Listed investments cost - disposals", "Unlisted investments cost - b/fwd", "Unlisted investments cost - additions", "Unlisted investments cost - disposals"], :cred_current=>["Non-equity preference shares", "Bank loans and overdrafts", "Obligations under lease contracts", "Trade creditors", "Amounts owed to group undertakings ", "Corporation tax", "Other taxes and social security costs", "VAT payments", "Accruals and deferred sales", "Other creditors"], :cred_greater=>["Non-equity preference shares", "Bank loans", "Obligations under lease contracts", "Amounts owed to group undertakings ", "Other creditors"], :capital=>["Profit and loss account", "Ordinary shares", "B Ordinary shares", "Share premium", "Revaluation reserve - b/fwd", "Arising on revaluation during the year", "Capital redemption reserve - b/fwd", "Transfer from the profit and loss account", "Prior year adjustments", "Dividends", "Transfer to capital redemption reserve", "No-Mapping"]})
        expect(tags.keys.count).to eq 16
      end
    end

    context "helpers" do
      it 'can find unique keys' do
        keys = Tag.extract_unique_keys { [key: "33", key_2: "Hello", "stringKey" => 1234]}
        expect(keys).to eq [:key, :key_2, "stringKey"]
      end
    end
   
  
  end
end
