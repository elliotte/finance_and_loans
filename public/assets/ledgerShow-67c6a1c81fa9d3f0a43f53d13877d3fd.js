function shareSuccess(){$("#empty-modal-table").empty(),response=this.responseText,html=response.indexOf("ERROR")>-1?'<p>ERROR</p><a href="/" data-no-turbolinks=true>RECONNECT</a>':"<td>Successfully shared Ledger with: "+response+"</td>",$("#empty-modal-table").append(html)}function addCommas(t){t+="";for(var e=t.split("."),a=e[0],n=e.length>1?"."+e[1]:"",r=/(\d+)(\d{3})/;r.test(a);)a=a.replace(r,"$1,$2");return a+n}var cashLedgerShow=function(){var t={Payments:"",Lodgements:"",Timeline:""};return{getPaymentsData:function(){var t=[["Tag","Amount"]],e=$(".payment_line");for(i=0;i<e.length;i++){var a=$(e[i]).data("tag"),n=parseFloat($(e[i]).data("total"));t.push([a,n])}return t},getLodgementsData:function(){var t=[["Tag","Amount"]],e=$(".lodgement_line");for(i=0;i<e.length;i++){var a=$(e[i]).data("tag"),n=parseFloat($(e[i]).data("total"));t.push([a,n])}return t},getTimeLineData:function(){var t=[["Desc","Amount"]],e=$(".transaction-line");for(i=0;i<e.length;i++){var a=$(e[i]).data("desc"),n=parseFloat($(e[i]).data("total"));t.push([a,n])}return t},loadData:function(){return t.Payments=this.getPaymentsData(),t.Lodgements=this.getLodgementsData(),t.Timeline=this.getTimeLineData(),t},displayShareLedgerModal:function(){$("#empty-modal-table").empty(),$("#table-title").empty(),$("#modal-table-empty").trigger("click"),friends=JSON.parse(localStorage.getItem("friends")).items,link='<a href="javascript:void(0)" onclick="cashLedgerShow.shareLedger(this)">Share</a>',$("#empty-modal-table").append('<p style="color:#F3655E;font-size:80%;">You can search your friends list using the browser CTRL + F feature</p>'),$.each(friends,function(t,e){imgSrc=e.image.url,html='<tr id="'+e.id+'"><td><img src="'+imgSrc+'" ></td><td>'+e.displayName+"</td><td>"+link+"</td></tr>",$("#empty-modal-table").append(html)})},shareLedger:function(t){shareUserID=t.parentNode.parentNode.getAttribute("id");var e=$("meta[name='csrf-token']").attr("content");ledgerID=$("#ledger-id").text();var a=new XMLHttpRequest;a.onload=shareSuccess,data={userID:shareUserID},route="/ledgers/"+ledgerID+"/share",console.log(route),a.open("put",route,!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("X-CSRF-Token",e),a.send(JSON.stringify(data))},setSummaryModals:function(){function t(t,e){return trns=$.map($(".transaction-line"),function(a){return _trn=$(a),_trn.data("tag")==t&&_trn.data("type")==e?_trn:void 0}),trns}function e(t){$(trns).each(function(t,e){amt=addCommas($(e).data("total")),html="<tr><td>"+$(e).data("date")+"</td><td>"+amt+"</td><td>"+$(e).data("desc")+"</td><td>"+$(e).data("tag")+"</td></tr>",$(table).append(html)}),$("#table-title").empty(),$("#table-title").append(t)}$(".lodgement-summary-display").on("click",function(){table=document.getElementById("empty-modal-table"),$(table).empty(),_tag=$(this).data("tag"),trns=t(_tag,"Debit"),e(_tag),$("#modal-table-empty").trigger("click")}),$(".payments-summary-display").on("click",function(){table=document.getElementById("empty-modal-table"),$(table).empty(),tag=$(this).data("tag"),trns=t(tag,"Credit"),console.log(trns),e(tag),$("#modal-table-empty").trigger("click")})}}}();