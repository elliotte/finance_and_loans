function cacheNotes(e){$.ajax({url:"/reports/"+e+"/get_notes",dataType:"JSON",type:"GET",success:function(e){localStorage.setItem("notes",JSON.stringify(e)),showNotes()}})}function cacheComments(e){$.ajax({url:"/reports/"+e+"/get_comments",dataType:"JSON",type:"GET",success:function(e){localStorage.setItem("comments",JSON.stringify(e)),showComments()}})}function showComments(){source=$("#comment-template").html(),templ=Handlebars.compile(source),comments=JSON.parse(localStorage.getItem("comments"));var e=templ(comments);$(".comments_data").html(e)}function showNotes(){source=$("#note-template").html(),templ=Handlebars.compile(source),notes=JSON.parse(localStorage.getItem("notes"));var e=templ(notes);$(".notes_data").html(e)}function showReportShareModal(){$("#bg-screen-for-modal").addClass("open"),link='<a href="javascript:void(0)" onclick="shareReport(this)" style="text-decoration:none;color:#94CFD5;"> Share</a>',$("#bg-screen-for-modal").find("section").empty().append('<p style="color:#94CFD5;font-size:80%;">You can search your friends list using the browser CTRL + F feature</p>'),friends=JSON.parse(localStorage.getItem("friends")).items,$.each(friends,function(e,t){imgSrc=t.image.url,html='<tr id="'+t.id+'"><td><img src="'+imgSrc+'" ></td><td>'+t.displayName+"</td><td>"+link+"</td></tr>",$("#bg-screen-for-modal").find("section").append(html)})}function shareReport(e){function t(){$("#bg-screen-for-modal").addClass("open"),response=this.responseText,html=response.indexOf("ERROR")>-1?'<p>ERROR</p><a href="/" data-no-turbolinks=true>RECONNECT</a>':"<td>Successfully shared Ledger with: "+response+"</td>",$("#bg-screen-for-modal").find("section").empty().append(html)}shareUserID=e.parentNode.parentNode.getAttribute("id");var a=$("meta[name='csrf-token']").attr("content");reportId=$("#report-id").val();var o=new XMLHttpRequest;o.onload=t,data={userID:shareUserID},route="/reports/"+reportId+"/share",console.log(route),o.open("put",route,!0),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("X-CSRF-Token",a),o.send(JSON.stringify(data))}function getFriendsList(e){link='<a href="javascript:void(0)" onclick="shareReport(this)">Share</a>',$("#friends").empty(),$.each(e,function(e,t){imgSrc=t.image,html='<tr id="'+t.id+'"><td><img src="'+imgSrc+'" height="42" width="42" ></td><td>'+t.displayName+"</td><td>"+link+"</td></tr>",$("#bg-screen-for-modal").find("section").find("table").append(html)}),$("#bg-screen-for-modal").find("section").find("table").append("</table>"),header='<article class="type-system-slab"><p>Search for your friends and collaborate</p></article>',$("#bg-screen-for-modal").find("section").prepend(header)}function intializeList(e){commonAutocomplete(" ",e)}function commonAutocomplete(e,t){$.ajax({url:$(t).data("autocompleteurl"),type:"GET",data:{q:e.term},success:function(e){getFriendsList(e)}})}$(document).on("page:load ready",function(){uiSharedHelper.setAccordianHandlers(),data=reportShowHelper.loadShowPageData(),graphHelper.drawReportShowCharts(data),$("#new-work-icon").click(function(){slideBar=$(".slider-action-bar"),slideBar.width()>70?(slideBar.animate({width:"40"},1e3),slideBar.children("a").fadeOut(),slideBar.children("a").remove()):slideBar.animate({width:"20%"},{duration:2e3,complete:function(){actionButtons=$("#hidden-buttons-for-bar").children("a").clone(),slideBar.append(actionButtons)}})})});var reportShowHelper=function(){var e=2;return{filterBy:function(e){function t(e){$.each(all_values,function(t,a){valueID=$(a).data("value-id"),rowHandler="tr#"+valueID,valueProp=$(a).data(e),filterVariable.indexOf(valueProp)>-1||filterVariable.indexOf("All")>-1?$(rowHandler).show():$(rowHandler).hide()})}switch(filterVariable=$(e).offsetParent().find(".summary").text().replace(/\s/g,"").split(","),filterFormat=$(e).attr("class"),all_values=$(".trn-report-mgr"),filterFormat){case"v_type":t("type");break;case"v_month":t("month");break;case"ifrstag":t("ifrstag");break;default:t("")}},loadValuesByMiTag:function(e,t,a){lineDescription=$(e).data("mitag"),allValues=$("."+t+"_"+lineDescription);var o=a;allValues=$.grep(allValues,function(e){return a=$(e).data("period"),a==o}),reportShowHelper.appendModalShowPageValues(allValues)},goTo:function(){var e=$("#show-page-bar-chart");$("html,body").animate({scrollTop:e.offset().top},1e3)},loadValuesByDescription:function(e,t){lineDescription=$(e).data("description"),allValues=$(".value-lookup");var a=t;showValues=$.grep(allValues,function(e){return t=$(e).data("period"),jsDesc=$(e).data("desc"),t==a&&jsDesc==lineDescription}),reportShowHelper.appendModalShowPageValues(showValues)},loadJournalValues:function(e,t){lineDescription=$(e).data("description"),allValues=$('[class^="etb"]');var a=t;showValues=$.grep(allValues,function(e){return t=$(e).data("period"),jsDesc=$(e).data("desc"),t==a&&jsDesc==lineDescription}),reportShowHelper.appendModalShowPageValues(showValues)},appendModalShowPageValues:function(e){function t(e){e+="";for(var t=e.split("."),a=t[0],o=t.length>1?"."+t[1]:"",r=/(\d+)(\d{3})/;r.test(a);)a=a.replace(r,"$1,$2");return a+o}$("#bg-screen-for-modal").addClass("open"),body=$("#bg-screen-for-modal").find("section"),body.empty().append('<div style="color:#477DCA;" id="table-title"></div>'),title=$("#table-title"),title.empty(),header='<table class="table-minimal"><tr style="color:#94CFD5;"><td>Type</td><td>Date</td><td>miTag</td><td>\xa3</td><td>moneaTag</td></tr>',html="",$.each(e,function(e,a){amt=t($(a).data("amount")),html=html+"<tr><td>"+$(a).data("type")+"</td><td>"+$(a).data("date")+"</td><td>"+$(a).data("mitag")+"</td><td>"+amt+"</td><td>"+$(a).data("ifrstag")+"</td></tr>"}),body.append(header+html+"</table>"),title.append('<p style="color:#FB7D98;">Summary:  '+lineDescription+"</p><br>")},loadShowPageData:function(){var e={cp:"",pp:""};return all_cy_RepLines=$(".cy-graph-rep-lines"),data=[["yourTag","Amount"]],$.each(all_cy_RepLines,function(e,t){tag=$(t).data("key"),amt=$(t).data("amount"),"undefined"!=typeof tag&&"undefined"!=typeof amt&&data.push([tag,amt])}),e.cp=data,all_pp_RepLines=$(".pp-graph-rep-lines"),data=[["yourTag","Amount"]],$.each(all_pp_RepLines,function(e,t){tag=$(t).data("key"),amt=$(t).data("amount"),"undefined"!=typeof tag&&"undefined"!=typeof amt&&data.push([tag,amt])}),e.pp=data,console.log(e),e},addValueToJournalForm:function(){if(e>30)alert("Only 30 Values allowed");else{var t=$(".value_template tbody").html();t=t.replace(/index/g,e),$(".etb_values tbody").append(t),e++}}}}();